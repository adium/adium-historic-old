$Id: ToDoList.txt,v 1.141 2004/05/16 19:39:56 adamiser Exp $

Legend
+ Change or Addition
- Removal
* Bug Fix
# Debatable (ASK and debate before doing!)

If you are working on something big and it may take a while, please tag it with your [name].


-------------------------------------------------------------------------------------------------------
Bugs - LibGaim
-------------------------------------------------------------------------------------------------------
* [ICQ] Displaying raw HTML (Messages sent from iChat)
	Libgaim is escaping all incoming HTML characters over ICQ.

* [MSN] Outoing chat appears twice
	Libgaim is sending our message back to us


-------------------------------------------------------------------------------------------------------
Bugs - Resources
-------------------------------------------------------------------------------------------------------
* Webkit styles rendering incorrectly in very wide windows
	The two included styles with problems are Smooth Operator and Mockie

* Webkit styles are inconsistently handling long lines
	All styles should use the overflow scrollbar if possible.  The following styles do not:
	Elisha, Minimal, Mockie, Retro, Simple

* Webkit styles must support multi-line status messages
	The included style with problems is Smooth Operator 


-------------------------------------------------------------------------------------------------------
Bugs - Adium
-------------------------------------------------------------------------------------------------------
* "Custom..." sound option is not working.
	The user is prompted for a custom sound, but it doesn't appear in the menu and doesn't save.

* Short emoticons mask longer ones
	For instance, :) prevents :)) from working.  A solution to this would be shorting all the text
	equivelants from longest to shortest, but the way we store emoticons makes this impossible.

* Message history is being colored
	History messages should be stripped of color before being passed to the message view, so they
	use the view's default text color (which is usually dimmed or special in some way)

* Escapes aren't processed in links
	The escapes are filtered using the plain text version of the message, so any escapes within the
	link attributes of the attributed message are not filtered.  This prevents subprofile links from
	working.

* Message formatting is reset on send
	If the user changes their message formatting, it should stay until that window is closed.  This
	causes problems for users who use right-to-left text entry, and users wishing to use a special
	message format temporarily.

* Applescripts are parsed in other's profiles
	This is a potential security risk if the user has scripts that run shell commands.  We shuold
	not be parsing script commands sent by other users (via profiles)

* Customize Toolbar doesn't disable
	This menu item should disable when there is no toolbar visible

* Spawning new windows unhides Adium
	We don't want to spawn new windows while Adium is hudden.  Windows should be qued and shown when
	Adium is unhid.

* Auto-resizing is not docking
	Auto-resizing is no longer docking to the bottom of the screen.

* Manual ordering not saving
	All manual ordering is lost on relaunch

* Contact list view goes behind toolbar
	It's possible for the contact list view to become stuck under the toolbar, covering the first
	few contacts on the list.  Toggling the toolbar will sometimes correct the view.

* Adding contact with no groups crashes
	Adding a contact with no groups defined crashes adium.

* Adding contact that already exists
	Adding an existing contact causes issues.  It may result in duplicate contacts on the user's
	list, and will make the contact appear offline.  Sometimes they will appear on the list 
	twice until Adium is restarted.


-------------------------------------------------------------------------------------------------------
Bugs - Deferred (Awaiting a rewrite / other change)
-------------------------------------------------------------------------------------------------------
* Info window can be opened with no selection
	Shows a blank window titled "window".  Waiting on info/inspector/alert merge.

* AIM chats are logging as (null)
	Happens with both loggers.  Waiting on full multi-chat support.


-------------------------------------------------------------------------------------------------------
Bugs - Unconfirmed
-------------------------------------------------------------------------------------------------------
* User icons are still getting flipped (Icons from AIM, apparently)
* We have issues with preventing the user from sending messages when they might actually be able to send (invisible AIM users, after we get disconnected?)
* Shift-command-left does not work as expected, according to http://www.visualdistortion.org/crash/view.jsp?crash=7722
* Update checker reporting a new version when non exists? (possibly a caching error?)
* If one tries to change one's idle time to a lower amount, (for example, from 2:32 to :36), an update will not occur, and your idle time will stay at 2:32.
* Tooltips are flashing when the contact list auto-resizes?
* Deleting an idle contact may cause a crash when the idle updates next? http://www.visualdistortion.org/crash/view.jsp?crash=10088
* Empty groups come back on next launch after being deleted?
* Unicode (German) messages not working over ICQ ?
* away messages aren't going away
* Yahoo giving some users a Gaim error: unknown error 29 on connect
	Evan: This is an unauthorized user error, so far as I can tell. I got it after trying a wrong password a ton of times in a row.  The linked image is one of those "type this distorted text to verify you're a person" things.
* We're receiving (but not processing/interpreting) HTML over ICQ
	Evan: Official ICQ clients send RTF, not HTML.  SIM is an unofficial one that does.  Gaim intentionally escapes HTML coming from ICQ for this reason... Odd.
* away messages aren't clearing when a buddy comes back from away?  Online buddies with away messages?
* We are having some text encoding issues with ICQ (multiple mentions)
* Do we support ISA proxies? (ISA and NTLM authorization).  Does gaim have support for these?
	- Evan: No, gaim proxy support is ancient.
* Yahoo ignore list is being ignored?
* Apple scripts can stall Adium when iTunes 4.5's Print dialogue is open
* Changing timezone doesn't update time stamps immediately (I'm not surprised, but this would be cool)
* Messages with invalid looking HTML <tags> received via jabber (from ICQ user over transport), the invalid tags are being eaten? (Our HTML decoder isn't eating them, is libgaim?) 
* We aren't fetching the display names of ICQ users, some icq users, when over AIM? (They still show up in the info, apparently)
* text to speech not working ?
* Dragging buddies on MSN account not working
* Contact screennames aren't appearing for all contacts when using ICQ
* AIM Passwords with question marks in them prevent libgaim from connecting?
* Jabber UIDs do not include the server.
	- Evan: The formattedUID does.  The UID should not.
* Out of curiosity - is there a reason we use .adiumEmoticonset instead of .adiumEmoticonSet (call me a capitalization nut :)? 

-------------------------------------------------------------------------------------------------------
Minor Changes
-------------------------------------------------------------------------------------------------------
Contacts:
	+ Allow specifying an image for a contact in the inspector (Independent of address book)
	+ Add area for typing contact notes to inspector, display notes in tooltip [Brian] 
                // notes in, tooltips spacing funky [tooltips off] Evan: tooltip indentation sucks right now.  I'll fix it next week.
	+ Add keyboard shortcut for the 'add contact' menu item
	+ Pass our aliases to libgaim so they get uploaded to the server?

Alerts:
	+ Allow user to have more control over what is spoken by the announcer plugin
	+ Display time stamps in the panel alert
	+ Support the %escapes in alert text (such as %n to speak the contact's name)

Contact List: 
	- Remove contact list font preference.  Hook this up to cmd-T
	- Remove the advanced option for vertical resizing, since this is already covered in the main preferences.
	* Renaming doesn't work at the moment.
	* Alias doesn't stick on quit. This is needed for those services that don't support certain characters.
	
Accounts:
	+ Auto-complete aliases in log viewer
	+ Add 'Priority' field to jabber advanced preferences

Message Window:
	+ Open new windows behind the frontmost window (When not opening in tabs) [Colin]
        I don't know quite what to do here. I'd like some guideance. <<< I never got any guidence, dammit! :P <<< Still lacking guidence here. We need to have a group chat about this...
	= Insert emoticon menu item, contextual menu item [Brian]
            // this can now be deemed done... although it should now be Insert Emoticon button/menu ala iChat/MSN/AIM in message view
	+ Tab-complete usernames in messages and chat
	+ Make 'save as' menu item work
	+ Accept dragged items and do wonderful things on them, like if it is text append it in the input field or if it is a file send it to the contact.
* Push/pop indicator could use 1-2 px extra spacing from the right & left since its nearly flush with the scrollbar 

Contact List Display:
	+ Small contact list icon to identify mobile device users
	+ With offline contacts visible, hide the group counting 'visible' value.

Other:
	+ Create a plugin to hide the AIM "Your screen name is now signed in 2 locations" messages
	+ '--insensitive' flag in AIEmoticon (to be placed in the TextEquivalents.txt file) that allows emoticons' text equivalents to be case-insensitive (without applying this nature globally to all emoticons).
		Colin: Didn't Mac-arena do this already?
	+ "New message..." dialog should search for all contacts, and then after that offer the protocols from where you can talk to the buddy found. The way it works now seems a bit rare, as you have to select the protocol first, and maybe you just don't remember or something and you type the name (address book for example) of your buddy just to see it doesn't work.
	+ Add preferences to disable 'Fast User Switching' auto-away, and to customize the message. [Colin]
	+ Create a plugin to parse sed expressions, similar to the tex plugin.
	+ Add export option to log viewer
	+ Fetch yahoo profiles from http://profiles.yahoo.com/[BUDDYNAME] for the info window (libgaim doesn't do this for us?)
	+ Jabber links, support xmpp:user@host/resource or xmpp:user@host  
    	+ Don't spawn new windows when we're hidden, instead que them and open the windows next time we're unhidden
	+ Display new mail notices for the accounts that support it.  This is bloat - but some people expect it.

-------------------------------------------------------------------------------------------------------
Big Stuff
-------------------------------------------------------------------------------------------------------

Contact alerts:
	Improve the contact alerts interface, reducing all editing to one window that is easier to use.
	(Model: http://homepage.mac.com/adamiser/sortathis6.png)

	Steps:
        = Remove alerts preference pane
	= Remove contact menu from alert window
	= Remove event popup from alert window
	= Disallow editing of events
	= Remove event view insertion (on selection)
	= Rework context menus.. change to "Edit Alerts"
	+ Add icons (16x16) to event types, and display them in the event list (still needed on some.  make the ESContactAlert subclasses respond to -icon)
	= Add toolbar to window, add, edit, delete
	= Add sheet for 'add', 'edit'.  Must be independent from alert window.
	= Sheet has event, action, and contact (submenued by group) popups.
	= Add source list on left of all objects with alerts
	= Clicking in source list changes displayed
	+ Menu has "all contacts in ___" items, and "all contacts" item (?)
	= Dynamically load view into sheet depending on selected alert
	= Redesign views, simplify, use big controls
	= Add "Add alert" context menu - that opens the sheet as a panel and allows easy adding
	= Add "Contact Alerts" menu item to window menu for opening alert window
	= Auto-fill sheet for new alert based on selection in window on clicking add

Contact list display:
	Add user icon and extended status display support to the contact list, and simplify its
	configuration to a small subset of nice looking cell arrangements.

	Details:
	+ Four components to the contact list:
	 	+ User Name - (Text) Name / Alias
	 	+ User Icon - (Image) AIM Buddy Icon / MSN Avatar / Address book icon
	 	+ Status Badge - (Image) Icon representing status, specified by user
	 	+ Extended Status - (Text) iChat status, away message, MSN state name, MSN user name/status
	+ User can toggle each component (except user name) on/off with view menu items
	+ User can choose whether icons are on left or right.  Status Badge always goes on opposite side
	+ If icons are visible, extended status is displayed below user name, otherwise displayed next to user name
	+ Add option to not display groups on the contact list (Be careful with this and manual ordering)

Status badges:
	- Remove status icons plugin
	+ Add images based status badges to the contact list
	+ Allow user to select icon sets (packaged in a bundle) in preferences

Event Notifications (the feature formerly known as Event Bezel):
    + Give the contact alert a nice icon.
    + Give the notification window a close widget to quick-dismish the event, if it is the last one close the thing entirely. Maybe if clicking it with option hold down should close all queued events altogether.
    + Give the notification window a mail dock icon like badge to show the total number of recent events to be shown on it
    + Add small pretty protocol icons (we need nice icons for this)
    # Add status icons (the desired thing should be to use the same ones as the ones in the forthcoming new contact list)
	# Give the notification window a titlebar, and allow it to be repositioned while visible.
      not sure about adding a titlebar to it [Jorge]
    = Hook the thing into the new alert system.    = Add one more advanced preference to make it unclickable, changing the visual appearance of the window so it is less obstrusive.
    = Detect when the bezel is displaying with no position info (from autoSaveFrameName) and put it in a default position like the old bezel "default" one.
	= Color the entire bezel to match the event being displayed
	= Make the bezel smaller, clearer, easier to read, prettier
	= Give the event info few preferences if any.

[Colin]
Contact Blocking:
    	Allow the user to easily block/unblock users by name, or users on their list.  Provide a way for them to see
    	all blocked names and add/remove from the list.  Ignore the AIM specific block 'modes'.

    	Steps:
	+ Add block and unblock menu items which prompt for the service and name
	+ Add block / unblock contextual menu items
	+ Add "Block contacts not on my list" to AIM account preferences


Contact Inspector:
    	Provide a contact inspector with a lot of room to grow, that is easy to use, organized, and lets the user
    	manage all their contact specific settigns in one place

    	Steps:
    	+ Convert inspector to preference-like window with a toolbar of categories
    	+ Update existing inspector views to use big controls, and place them in the inspector categories
    	+ Move contact info into a category in the inspector

Documentation
	Documentation is considered one of the most important parts of a project. It is also the most tedious part. We need good documentation in order to assist users and developers. These should include screen shots if possible (visual aid). Documentation should not be moved to the done portion of this list until every other part is done, as things may change.

	+ User documentation
		
	+ Developer Documentation
		+ We already have some documentation. This needs to be gone through
		+ Creating webkit themes
		+ Address book integration

Activity Window [boredzo]
Will sort of resemble Safari's. Entries in the window only reflect progress of items; actions are performed from the toolbar.
* Toolbar items are stuck in disabled state
+ Get Show Completed working
+ Get Filter field working
	+ ...including under Jaguar (need to create it programmatically in that event, since IB Services on Jaguar won't unarchive it)
		
-------------------------------------------------------------------------------------------------------
Areas that require more thought before implementing
-------------------------------------------------------------------------------------------------------
New State System:
    Allow users to create 'states' that describe their activity online.  States would set their status
    across the various protocols and allow them to alert certain behavior in Adium (Window spawning, 
    sounds, alerts, notifications, etc).  The goal is to replace the protocol specific state systems
    (idle & away) with something that better suits a user connected to multiple protocols, and allow
    Adium's behavior to be better customized to a user's diverse 'states' of IM throughout the day.

Multi-user chat:
    Powerful multi-user chat that can handle both large, moderated rooms (irc) and multi-way IMs (MSN).
		- Tick: would we want a drawer or a list, or a collapsable list or what? Everyone seems opposed to a drawer, so a list would do better.
    
Contact status coloring:
    Status coloring that is easy to configure and consistant throughout Adium.

Meta Contacts:
    Provide a way for users to create and manage their own meta contacts.    

Protocol Specific Functions:
    Provide a menu for service code to insert protocol specific options.  Things such as buddy search,
    password changing, getting info on non-listed users, etc.

File Transfer:
    Non-intrusive prompts, download management, drag & drop transfer, previewing, direct connect,
    progress feedback, etc.

Event integration:
    Shift control of sound playing and dock bouncing to the event controller, keeping the existing preferences
    as a front to hidden events in the event system.  To reduce duplicate code and provide better behavior
    for custom sound and bounce settings that would otherwise conflict.

Deferring of initial message:
   Don't pop up a message window if one doesn't already exist.  Use some kind of dock indicator / list indicator.  Double click on list or dock menu item would display the message.  If a window is already open, new messages would create a tab as normal.  We could associate this option with the state system for some pretty cool behavior.

Contact List import/export:
   Import/export code is not fun. 

Sorting:  Allow a 'minor' sort option like iChat?  (iChat uses the last selected as the subsort).  Not sure if this would be useful.

Too many tabs issue:
	It seems that if you have too many tabs, then the tabs come to a point of not being usable. Tabs rock, but with 15 open windows intrinsic issues with this approach start to appear. We could:

	1) Offer a side list/drawer as an option.
	2) Have the arrows thing like in gaim and other clients.
	3) Multiple rows of tabs

	This will require a great deal of thought probably, and may not be resolvable for all parties.
        
Link Management:
    Just throwing out a thought for discussion... how about a button like those for emoticons or push/pop with add/edit and a list of favorites to make them accessible within the message view without using contextual menus? In that same vein... what about autocompleting recognized URLs (such as www.ad completes to www.adiumx.com if its a favorite)? 
	//Steve: yeah, both of those seem to be good ideas, and the link editor window is certainly abstract enough to be called through most any mechanism, and I had always intended a button to be included for it eventually.  Auto-completing URLs is an interesting idea... and would work very well if done right.  I'd comment more, but I'm feeling a little under the weather right now. :\
    
-------------------------------------------------------------------------------------------------------
Unfixable(?) Issues
-------------------------------------------------------------------------------------------------------
* Stop contact list from auto-resizing under the dock
	It does not auto-resize under the dock EXCEPT for at the edges, by design, since many people use a dock which does not extend to the edges of the screen and would like the contact list to reach down there.  So far as I can tell there's no way to know how
 wide the dock is; only how tall it is.

* Don't overwrite user specified icons in the address book.  Only overwrite iChat placed icons (and store ours such that iChat will overwrite them) 
	- (Evan: I spent an hour going through private frameworks trying to figure this out.  If you have any ideas, please let me know.)
	- (Tick: Maybe we can use steganography, crysflame in irc brought it up, and eevyl and I have discussed it before:
			19:45 < crysflame> http://www.mirrors.wiretapped.net/security/steganography/outguess/outguess-0.2.tar.gz and 
http://www.mirrors.wiretapped.net/security/steganography/stegdetect/stegdetect-0.5.tar.gz

* Fix the Output Device Control plugin so it doesn't crash on Jaguar (unfixable?) Alternatively, figure out a way to have it be on by default in Panther, but off in Jaguar.

* WebKit caching is meaning that buddy icons don't update until Adium restarts.

* If you uncheck the "play user interface feedback sounds" in System preferences, and disable the "Use Custom Volume" checkbox in Adium, no sounds are played


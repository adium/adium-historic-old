$Id: ToDoList.txt,v 1.120 2004/05/12 12:00:40 eevyl Exp $


Legend
+ Change or Addition
- Removal
* Bug Fix
# Debatable (ASK and debate before doing!)
= Done (Move to the bottom)

If you are working on something big and it may take a while, please tag it with your [name].

-------------------------------------------------------------------------------------------------------
Bugs
-------------------------------------------------------------------------------------------------------
* "Custom..." sound option is not working.
* We are not processing HTML that arrives over an ICQ connection.  Some clients (such as iChat) send HTML over ICQ.
* If you uncheck the "play user interface feedback sounds" in System preferences, and disable the "Use Custom Volume" checkbox in Adium, no sounds are played
* Don't spawn new windows when we're hidden, doing so will unhide us (Show the windows next time we're unhidden)
* Shift-command-left does not work as expected, according to http://www.visualdistortion.org/crash/view.jsp?crash=7722
* User icons are still getting flipped (Icons from AIM, apparently)
* Clicking the info button with nothing selected (1 group, 0 contacts defined) shows a blank window titled "Window"
* We have issues with preventing the user from sending messages when they might actually be able to send (invisible AIM users, after we get disconnected?)
* Multi-user chat (MSN) - sent messages appear twice.
* Update checker reporting a new version when non exists? (possibly a caching error?)
* Some webstyles clip long lines, others show a scrollbar.  We should be consistent with our behavior if possible (Adam votes scrollbar)
* Message formatting is reset after each message sent (was this an intentional change? - it resets things such as right-to-left typing as well)
* Links with %n's in them beep when clicked (Set a %n link in your profile using AOLIM)
* Linking plugin auto-links some characters it shouldn't.. such as *'s and >'s (When placed at the end of an address)
* Smooth operator and Elisha webkit styles incorrectly display multi-line status messages.
* Emoticon packs flip upside down when you select them.  (The emoticon menu is causing them to flip, so only enabled packs will be flipped.  No amount of flipping and unflipping within the emoticon pack cell seems to make things correct)

Applescripts:
* Applescript substitions (/music and friends) are parsed in other peoples' profiles and away messages.

Contact List:
* Adding a contact that's already online causes them to appear signed off on the list.
* Adding buddies, sometimes they'll show up on the list twice until a restart
   - (Hanji: I've had this happen, but can't trace under what circumstances. It does seem to happen when adding myself a lot, however)
* When connected to an msn account with no groups or contacts, clicking the drawer button on the contact list makes the contact list window disappear.
* Adding a contact with no groups defined crashes adium.
* Adding a group makes the contact list window reappear.
* Auto-resizing is no longer correctly sticking to the bottom of the screen?
* Offline contacts are not always displaying (Show them, disconnect, and then re-connect.  They are gone)
* Orphans group  (Hey, the behavior is strange, so I'd consider this a bug)
* Manual ordering is lost when Adium is quit and relaunched.

-------------------------------------------------------------------------------------------------------
Unconfirmed bugs
-------------------------------------------------------------------------------------------------------
* There is an issue with contact list resizing that can result in tooltips tracking contacts who are 'behind' the toolbar, and none of the contact list content appearing (apparently because it is 'behind' the toolbar)
* Tooltips are flashing when the contact list auto-resizes?
* Deleting an idle contact may cause a crash when the idle updates next? http://www.visualdistortion.org/crash/view.jsp?crash=10088
* Empty groups come back on next launch after being deleted?
* Unicode (German) messages not working over ICQ ?
* away messages aren't going away
* Yahoo giving some users a Gaim error: unknown error 29 on connect
	Evan: This is an unauthorized user error, so far as I can tell. I got it after trying a wrong password a ton of times in a row.  The linked image is one of those "type this distorted text to verify you're a person" things.
* We're receiving (but not processing/interpreting) HTML over ICQ
	Evan: Official ICQ clients send RTF, not HTML.  SIM is an unofficial one that does.  Gaim intentionally escapes HTML coming from ICQ for this reason... Odd.
* away messages aren't clearing when a buddy comes back from away?  Online buddies with away messages?
* We are having some text encoding issues with ICQ (multiple mentions)
* Do we support ISA proxies? (ISA and NTLM authorization).  Does gaim have support for these?
	- Evan: No, gaim proxy support is ancient.
* Yahoo ignore list is being ignored?
* Message history and 'ignore formatting' option is doing some odd stuff (ignoring the ignore?)

* Apple scripts can stall Adium when iTunes 4.5's Print dialogue is open
* Changing timezone doesn't update time stamps immediately (I'm not surprised, but this would be cool)
* Messages with invalid looking HTML <tags> received via jabber (from ICQ user over transport), the invalid tags are being eaten? (Our HTML decoder isn't eating them, is libgaim?) 
* We aren't fetching the display names of ICQ users, some icq users, when over AIM? (They still show up in the info, apparently)
* text to speech not working ?
* Dragging buddies on MSN account not working
* Contact screennames aren't appearing for all contacts when using ICQ
* AIM Passwords with question marks in them prevent libgaim from connecting?
* Jabber UIDs do not include the server.
	- Evan: The formattedUID does.  The UID should not.

-------------------------------------------------------------------------------------------------------
Minor Changes
-------------------------------------------------------------------------------------------------------
Contacts:
	+ Allow specifying an image for a contact in the inspector (Independent of address book)
	+ Add area for typing contact notes to inspector, display notes in tooltip [Brian] 
                // notes in, tooltips spacing funky [tooltips off] Evan: tooltip indentation sucks right now.  I'll fix it next week.
	+ Add keyboard shortcut for the 'add contact' menu item
	+ Pass our aliases to libgaim so they get uploaded to the server?

Alerts:
	+ Allow user to have more control over what is spoken by the announcer plugin
	+ Display time stamps in the panel alert
	+ Support the %escapes in alert text (such as %n to speak the contact's name)

Contact List: 
	- Remove contact list font preference.  Hook this up to cmd-T
	- Remove the advanced option for vertical resizing, since this is already covered in the main preferences.
	* Renaming doesn't work at the moment.
	* Alias doesn't stick on quit. This is needed for those services that don't support certain characters.
	
Accounts:
	+ Auto-complete aliases in log viewer
	+ Add 'Priority' field to jabber advanced preferences

Message Window:
	+ Open new windows behind the frontmost window (When not opening in tabs) [Colin]
        I don't know quite what to do here. I'd like some guideance. <<< I never got any guidence, dammit! :P <<< Still lacking guidence here. We need to have a group chat about this...
	= Insert emoticon menu item, contextual menu item [Brian]
            // this can now be deemed done... although it should now be Insert Emoticon button/menu ala iChat/MSN/AIM in message view
	+ Tab-complete usernames in messages and chat
	+ Make 'save as' menu item work
	+ Accept dragged items and do wonderful things on them, like if it is text append it in the input field or if it is a file send it to the contact.

Contact List Display:
	+ Small contact list icon to identify mobile device users
	+ With offline contacts visible, hide the group counting 'visible' value.

Other:
	+ Create a plugin to hide the AIM "Your screen name is now signed in 2 locations" messages
	+ '--insensitive' flag in AIEmoticon (to be placed in the TextEquivalents.txt file) that allows emoticons' text equivalents to be case-insensitive (without applying this nature globally to all emoticons).
		Colin: Didn't Mac-arena do this already?
	+ "New message..." dialog should search for all contacts, and then after that offer the protocols from where you can talk to the buddy found. The way it works now seems a bit rare, as you have to select the protocol first, and maybe you just don't remember or something and you type the name (address book for example) of your buddy just to see it doesn't work.
	+ Add preferences to disable 'Fast User Switching' auto-away, and to customize the message. [Colin]
	+ Create a plugin to parse sed expressions, similar to the tex plugin.
	+ Add export option to log viewer
	+ Fetch yahoo profiles from http://profiles.yahoo.com/[BUDDYNAME] for the info window (libgaim doesn't do this for us?)
	+ Jabber links, support xmpp:user@host/resource or xmpp:user@host  
    	+ Don't spawn new windows when we're hidden, instead que them and open the windows next time we're unhidden
	+ Display new mail notices for the accounts that support it.  This is bloat - but some people expect it.

-------------------------------------------------------------------------------------------------------
Big Stuff
-------------------------------------------------------------------------------------------------------

Contact alerts:
	Improve the contact alerts interface, reducing all editing to one window that is easier to use.
	(Model: http://homepage.mac.com/adamiser/sortathis6.png)

	Steps:
        = Remove alerts preference pane
	= Remove contact menu from alert window
	= Remove event popup from alert window
	= Disallow editing of events
	= Remove event view insertion (on selection)
	= Rework context menus.. change to "Edit Alerts"
	+ Add icons (16x16) to event types, and display them in the event list (still needed on some.  make the ESContactAlert subclasses respond to -icon)
	= Add toolbar to window, add, edit, delete
	= Add sheet for 'add', 'edit'.  Must be independent from alert window.
	= Sheet has event, action, and contact (submenued by group) popups.
	= Add source list on left of all objects with alerts
	= Clicking in source list changes displayed
	+ Menu has "all contacts in ___" items, and "all contacts" item (?)
	= Dynamically load view into sheet depending on selected alert
	= Redesign views, simplify, use big controls
	= Add "Add alert" context menu - that opens the sheet as a panel and allows easy adding
	= Add "Contact Alerts" menu item to window menu for opening alert window
	= Auto-fill sheet for new alert based on selection in window on clicking add

Contact list display:
	Add user icon and extended status display support to the contact list, and simplify its
	configuration to a small subset of nice looking cell arrangements.

	Details:
	+ Four components to the contact list:
	 	+ User Name - (Text) Name / Alias
	 	+ User Icon - (Image) AIM Buddy Icon / MSN Avatar / Address book icon
	 	+ Status Badge - (Image) Icon representing status, specified by user
	 	+ Extended Status - (Text) iChat status, away message, MSN state name, MSN user name/status
	+ User can toggle each component (except user name) on/off with view menu items
	+ User can choose whether icons are on left or right.  Status Badge always goes on opposite side
	+ If icons are visible, extended status is displayed below user name, otherwise displayed next to user name
	+ Add option to not display groups on the contact list (Be careful with this and manual ordering)

Status badges:
	- Remove status icons plugin
	+ Add images based status badges to the contact list
	+ Allow user to select icon sets (packaged in a bundle) in preferences

Event Notifications (the feature formerly known as Event Bezel):
    + Hook the thing into the new alert system. Give it a nice icon for it too.
    + Give the notification window a close widget to quick-dismish the event, if it is the last one close the thing entirely. Maybe if clicking it with option hold down should close all queued events altogether.
    + Give the notification window a mail dock icon like badge to show the total number of recent events to be shown on it
    + Add small pretty protocol icons (we need nice icons for this)
    # Add status icons (the desired thing should be to use the same ones as the ones in the forthcoming new contact list)
	# Give the notification window a titlebar, and allow it to be repositioned while visible.
      not sure about adding a titlebar to it [Jorge]
    = Add one more advanced preference to make it unclickable, changing the visual appearance of the window so it is less obstrusive.
    = Detect when the bezel is displaying with no position info (from autoSaveFrameName) and put it in a default position like the old bezel "default" one.
	= Color the entire bezel to match the event being displayed
	= Make the bezel smaller, clearer, easier to read, prettier
	= Give the event info few preferences if any.

[Colin]
Contact Blocking:
    	Allow the user to easily block/unblock users by name, or users on their list.  Provide a way for them to see
    	all blocked names and add/remove from the list.  Ignore the AIM specific block 'modes'.

    	Steps:
	+ Add block and unblock menu items which prompt for the service and name
	+ Add block / unblock contextual menu items
	+ Add "Block contacts not on my list" to AIM account preferences


Contact Inspector:
    	Provide a contact inspector with a lot of room to grow, that is easy to use, organized, and lets the user
    	manage all their contact specific settigns in one place

    	Steps:
    	+ Convert inspector to preference-like window with a toolbar of categories
    	+ Update existing inspector views to use big controls, and place them in the inspector categories
    	+ Move contact info into a category in the inspector

Documentation
	Documentation is considered one of the most important parts of a project. It is also the most tedious part. We need good documentation in order to assist users and developers. These should include screen shots if possible (visual aid). Documentation should not be moved to the done portion of this list until every other part is done, as things may change.

	+ User documentation
		
	+ Developer Documentation
		+ We already have some documentation. This needs to be gone through
		+ Creating webkit themes
		+ Address book integration
		
-------------------------------------------------------------------------------------------------------
Areas that require more thought before implementing
-------------------------------------------------------------------------------------------------------
New State System:
    Allow users to create 'states' that describe their activity online.  States would set their status
    across the various protocols and allow them to alert certain behavior in Adium (Window spawning, 
    sounds, alerts, notifications, etc).  The goal is to replace the protocol specific state systems
    (idle & away) with something that better suits a user connected to multiple protocols, and allow
    Adium's behavior to be better customized to a user's diverse 'states' of IM throughout the day.

Multi-user chat:
    Powerful multi-user chat that can handle both large, moderated rooms (irc) and multi-way IMs (MSN).
		- Tick: would we want a drawer or a list, or a collapsable list or what? Everyone seems opposed to a drawer, so a list would do better.
    
Contact status coloring:
    Status coloring that is easy to configure and consistant throughout Adium.

Meta Contacts:
    Provide a way for users to create and manage their own meta contacts.    

Protocol Specific Functions:
    Provide a menu for service code to insert protocol specific options.  Things such as buddy search,
    password changing, getting info on non-listed users, etc.

File Transfer:
    Non-intrusive prompts, download management, drag & drop transfer, previewing, direct connect,
    progress feedback, etc.

Event integration:
    Shift control of sound playing and dock bouncing to the event controller, keeping the existing preferences
    as a front to hidden events in the event system.  To reduce duplicate code and provide better behavior
    for custom sound and bounce settings that would otherwise conflict.

Deferring of initial message:
   Don't pop up a message window if one doesn't already exist.  Use some kind of dock indicator / list indicator.  Double click on list or dock menu item would display the message.  If a window is already open, new messages would create a tab as normal.  We could associate this option with the state system for some pretty cool behavior.

Contact List import/export:
   Import/export code is not fun. 

Sorting:  Allow a 'minor' sort option like iChat?  (iChat uses the last selected as the subsort).  Not sure if this would be useful.

-------------------------------------------------------------------------------------------------------
Unfixable(?) Issues
-------------------------------------------------------------------------------------------------------
* Stop contact list from auto-resizing under the dock
	It does not auto-resize under the dock EXCEPT for at the edges, by design, since many people use a dock which does not extend to the edges of the screen and would like the contact list to reach down there.  So far as I can tell there's no way to know how
 wide the dock is; only how tall it is.

* Don't overwrite user specified icons in the address book.  Only overwrite iChat placed icons (and store ours such that iChat will overwrite them) 
	- (Evan: I spent an hour going through private frameworks trying to figure this out.  If you have any ideas, please let me know.)
	- (Tick: Maybe we can use steganography, crysflame in irc brought it up, and eevyl and I have discussed it before:
			19:45 < crysflame> http://www.mirrors.wiretapped.net/security/steganography/outguess/outguess-0.2.tar.gz and 
http://www.mirrors.wiretapped.net/security/steganography/stegdetect/stegdetect-0.5.tar.gz

* Fix the Output Device Control plugin so it doesn't crash on Jaguar (unfixable?) Alternatively, figure out a way to have it be on by default in Panther, but off in Jaguar.

* WebKit caching is meaning that buddy icons don't update until Adium restarts.

-------------------------------------------------------------------------------------------------------
Waiting On
-------------------------------------------------------------------------------------------------------

-------------------------------------------------------------------------------------------------------
Done
-------------------------------------------------------------------------------------------------------
Bug Fixes:
= Account name not displaying correctly after service switch
= accountXferDestroy in CBGaimAccount appears to be doing.. something.. wrong, causing a lot of file transfer crashes.
= 'Auto-Away' controls do not dim when there are no away messages (configureControlDimming overrides savedAwaysMenu)
= 'Auto-Away' menu dimming does not refresh when away messages are changed
= 'Auto-Away' menu does not refresh when away messages are changed
= Auto-Idle does not remove when 'Auto-Away' is turned on (Set them both to 1 minute, wait, click 'return', idle stays)
= Contact alerts window is still registering for a notification when the account changed, but not implementing an action method.
= Contact list display format preference not applying correctly on launch
= Deleting a "new account" doesn't display <New Account> as the name in  the resulting confirmation dialogue
= Deleting the default theme makes the prefs crash on subsequent loads.
= If preferences are selected to advanced on close, the window will be vertically small on re-open.
= In certain fonts, the tails of letters will stain in the text entry field after it clears.  This is visible with HoeflerText(size 12) - type a few j's and then press esc to clear the field. (hehe)
= Libgaim disconnect errors are being displayed, and not ignored (since they are handled internally)
= Message tabs are not refreshing correctly when status changes (Fixed?)
= Mousekeys to move tabs causes a crash: http://www.visualdistortion.org/crash/view.jsp?crash=5930
= Preference window crashes if you have a color picker open, close the window, and then click inside the picker.  The colorwell just needs to be told activate:NO in viewWillClose.  Fixing this requires verifying that viewWillClose is being called on advan
= Prevent cmd-delete from working in the message window
= Pushing escape clears the text field, instead of allowing you to convert from kanji to roman. This can be considered a bug, but some people like the escape key to be used to clear the text field too, so maybe this could be a preference or something.
	Evan: I say we just take this nonstandard 'feature' out.
	Colin: It's not nonstandard and it's a good feature.
	Evan: Okay, okay, popular response has been that they love it.  We'll think about a revised Keybaord preferences, perhaps in the Sending tab, to encapsulate this and maybe other preferences?
= Spaces in the address book STILL don't work properly, and they really should be better now. Grr.
= Stray tab divider is displaying when dragging tabs
= Version checker reports 'up to date' when there is no net connection (and when the server cannot be reached?)
= We have a 10.2.8 crash in contact list resize code, somehow: http://www.visualdistortion.org/crash/view.jsp?crash=8008 (There are a couple like this)
= When dragging a tab off quickly, it is possible for the tab bar to not finish moving to the correct position or to crash.
= Window content is drawing 2 pixels to the left when dragging tabs
ced preference panes.
= Fix the Output Device Control plugin so it doesn't crash on Jaguar (unfixable?) Alternatively, figure out a way to have it be on by default in Panther, but off in Jaguar.
= We aren't processing <code> tags in our HTML decoder (Jabber uses them)
	- (Tick: I thought jabber sent xml...???)
= Getting other strange 'code' in incoming jabber messages (xmlns=, ...)
= Is jabber working correctly?  Are we receiving status for buddies upon initially connecting?  Need to check this.
= Changing an alias in the inspector does not correctly update the contact list
= Some URLs in profiles aren't allowing clicks properly (Ones that include %n ?)
= Away messages with special characters (such as opt-n-n) show up as "Away:YES' in Adium (even when set by an Adium client)
= Jabber behaves incorrectly when you connect from another location (on, off, on, off, ...) (I've heard that yahoo does this as well)
= We have issues with not notifying the user when a message fails to send
= Users are still reporting issues with the contact list display format pref not being correct on launch.
= Tooltip code does not like the contact list 'hide while in background' preference.  Lots of issues
= Tooltip code does not like the multiple-desktop apps, or users who press cmd-H with the cursor over the contact list
= Tooltip code can crash if the listobject disappears out from under it, somehow. http://www.visualdistortion.org/crash/view.jsp?crash=8128
= Message history 'date' timestamps are not using localized time strings
= GROUP DRAGGING IS BROKEN.  Try it :)
= MSN freezes in glib (g_ascii_strncasecmp) when sending a &
= Place contact list on external monitor, quit, reboot without external monitor.  Contact list is gone...gone..gone.gone :)
= Add some indication of service to the 'enter password' window.  Multiple accounts with the same name are indistinguishable
= Interact with libgaim via a thread to improve responsiveness during connect/disconnect/poor connectivity
= Adding a contact that already exists on the list seems to cause problems
= Can "add" a contact with no accounts (the button should dim with no accounts checked)
= Only one password request dialog is allowed at a time.  This limitation causes issues for users with multiple accounts who don't save passwords.
= When typing in a username into Preferences : Accounts, updating the title on the left prevents me from typing briefly.  like, if i type "65745" and then pause and then start typing again, it's busy thinking about what is just typed.
= Connection failures due to a disconnected network (at least with Airport) cause the password to be cleared and re-prompted for.
= We are prompting for passwords on auto-reconnect like crazy.
= Improve validateMenuItem: efficiency programwide to fix hangs when dropping down menus.

Features & Changes:
= Add /music script that shows "Hip-hoppin' to __ by DJ __ on my GhettoBlasta"
= Add a 'None' soundset 
= Add checkboxes in source list to enable/disable packs
= Add dividers to view menu
= Add Offline status coloring
= Add support for displaying emoticon images (webkit message view)
= Add support for the scrolling / paging keys in the WebKit View
= Auto-complete aliases in New Message prompt
= Change window cycling menu items to 'Previous Chat' 'Next Chat'
= Clean up emoticon preference layout.  Move checkbox next to pack name, align icons, adjust padding, etc.
= Create new account, tab from username->pass->account list.  Next tab should go back to username
= Display 'New Account' in account list for accounts without a UID
= Interact with libgaim via a thread to avoid beachballing (Wait for Scott's patch - libgaim 0.76!, should fix)
= iTunes %_status script should display "Not Playing" when iTunes isn't open
= iTunes script runner should load scripts from the Application Support directory
= Make option-clicking a tab close button close all other tabs
= Make selecting an account in the menu connect / disconnect
= Make source list display all available emoticon packs
= Make the "Custom Tab Status Coloring" preferences work as intended (if disabled, the contact list labels colors are used for tab text colors).
= Move user name field out of account code and into account list preferences code
= Remember last X lines of previous conversation, restore to new message windows [Dave]
= Remove "per-contact" window position/size saving.  Use size/position of last window, cascade new ones 
= Remove sorting preferences.  Consolidate these and place them in the view menu - (Evan: MINOR CHANGE?! I'm hurt.)
= Remove submenus from accounts in the File menu
= Revamp emoticons preferences
= Tab scrubbing.  If control is held when mousing over a tab, select that tab
= We probably need a default priority preference.
= Webkit: Add keypress forwarding
= WebKit: Add support for displaying buddy icons using the UserIconPath status object
= Tabbing through account pref fields (yahoo) is no longer working [regression]
= Changes to the password field (Account prefs) aren't applied when connect is clicked.
= Allow user to cancel connecting of accounts
= Standardize on the service description for Oscar accounts - do something like "AIM, ICQ, and .Mac" in the services dropdown, in the new message prompt, etc.
= Insert/Edit link menu item, accompanying link entry panel.
= Edit link context menu
= WebKit Message View: Add preference to switch active style, preview styles
= WebKit Message View: Add preference to switch variants for the active style
= AIM accounts should show AIM as their service type, while ICQ should show ICQ, .Mac show .Mac, etc.
= Add to buddy list menu item, contextual menu item (for strangers)
= Add account specific proxy fields (Type, host, port) for all libgaim connections
= Adium will unhide if hidden (via cmd-H) while a tooltip is visible
= GROUP DRAGGING IS BROKEN
= Contact list transparency is incorrect (the background is black/opaque) when the window is first opened.
= Apple scripts will prompt for the location of itunes multiple times on launch if it's not installed.
= Contact list flippy triangles are white behind them in 10.2
= Add Contact should have more intelligent defaults, and generally be less of a pain
= Magnetic Windows:  Use Fire's 'solution' of sliding them to screen edges after a drag.
= Our 'new message' toolbar button is gooooone gone gone gone gone
= For contacts with no Adium alias and a matching address book card, the contact list format preference will be ignored.  So, if it's set to "Alias (Contact Name)", it will only display the address book name at first.  If the preference is toggled, the correct formatting will be applied.
